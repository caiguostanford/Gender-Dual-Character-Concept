---
title: "Study 2a"
author: "Cai Guo"
date: "11/12/2017"
output:
  html_document:
    toc: yes
    toc_depth: 3
    toc_float:
      collapsed: false
---
```{r message=FALSE, warning=FALSE, include=FALSE}
library(ggplot2)
library(dplyr)
library(tidyr)
library(lmerTest)
library(car)
library(lme4)
library(BayesFactor)
library(gridExtra)
library(cowplot)
```

```{r message=FALSE, warning=FALSE, include=FALSE}
dv = read.csv("~/Desktop/Stanford/Dual Character Concepts/Dual Character Concept Data/Study 2a.csv")

#Remove participants who did not answer the attention check question correctly.
dv = dv %>%
  filter(Filter==1)

#Turn dataset into long form. 
dv_tidy = dv %>%
  mutate(index=rownames(dv)) %>%
  gather(variable, value, Clear.Art:Ultim.Woman) %>%
  group_by(index) %>%
  separate(variable, into=c("Statement", "Concept"))

#Label variables
dv_tidy$Statement = as.factor(dv_tidy$Statement)
levels(dv_tidy$Statement)[levels(dv_tidy$Statement)=="Clear"] <- "Member"
levels(dv_tidy$Statement)[levels(dv_tidy$Statement)=="Ultim"] <- "Nonmember"

dv_c = within(dv_tidy, {Type = ifelse(Concept %in% c("Art", "Criminal", "Love", "Friend", "Mentor", "Comedian", "Minister", "Theory", "Boyfriend", "Argument"), "DualCharacter", ifelse(Concept %in% c("Rustling", "Welder", "Catalog", "Chair", "Firefighter", "Uncle", "Cashier", "Stroller", "Obituary", "Cousin"), "Control", ifelse(Concept %in% c("Man", "Woman"), "Gender", "NaturalKind")))})
```

#Demographics
```{r message=FALSE, warning=FALSE}
#1 = Female, 2 = Male, 3 = Other
prop.table(table(dv$Gender))
#Age
summary(dv$Age)
```

#Compare Man and Woman to decide whether to combine or separate them in subsequent analyses.
```{r message=FALSE, warning=FALSE}
#since there's only 1 concept within Man and Woman respectively, we do not include Concept but only subject (index) as a random effect. 

dv_gc = dv_c %>%
  filter(Type == "Gender")
lmvg = lmer(value~Statement*Concept+(1|index), dv_gc)
lmerTest::anova(lmvg)
summary(lmvg)

dv_gvn = dv_gc %>%
  filter(Statement == "Nonmember")
lmvgn = lmer(value~Concept+(1|index), dv_gvn)
lmerTest::anova(lmvgn)
summary(lmvgn)

dv_gvm = dv_gc %>%
  filter(Statement == "Member")
lmvgm = lmer(value~Concept+(1|index), dv_gvm)
lmerTest::anova(lmvgm)
summary(lmvgm)
```

The results showed that Man and Woman were indeed significantly different from each other. Therefore, we treated the two as separate types in subsequent analyses. 

```{r message=FALSE, warning=FALSE, echo=FALSE}
sem <- function(x) {sd(x, na.rm=TRUE) / sqrt(length(x))}

ci <- function(x) {qt(.975, df=length(x)-1)*sem(x)}

agggv2 <- dv_gc %>%
  group_by(Concept, Statement) %>%
  summarise(Mean = mean(value,na.rm=T),
            se = ci(value),
            upper = Mean + se,
            lower = Mean - se)

ggplot(agggv2,aes(x=Concept, y=Mean, fill=Statement, label = round(Mean, digits=2))) +
  geom_bar(position="dodge", stat="identity", col = "black") + scale_fill_manual(values=c("grey", "white")) +
  geom_errorbar(   aes( ymax=upper, ymin=lower ) , 
                     		width   =.25,
	                    	linetype="solid", position=position_dodge(.9)
	                    	) + 
  theme_bw() + ggtitle("Ratings of Statements by Concept and Statement Type") + geom_text(size = 3, position = position_dodge(width=.9), vjust=7)
```


#The model testing the effects of statement type and concept type and their interaction 
```{r message=FALSE, warning=FALSE}
dv_c1 = within(dv_tidy, {Type = ifelse(Concept %in% c("Art", "Criminal", "Love", "Friend", "Mentor", "Comedian", "Minister", "Theory", "Boyfriend", "Argument"), "DualCharacter", ifelse(Concept %in% c("Rustling", "Welder", "Catalog", "Chair", "Firefighter", "Uncle", "Cashier", "Stroller", "Obituary", "Cousin"), "Control", ifelse(Concept=="Man", "Man",  ifelse(Concept=="Woman", "Woman", "NaturalKind"))))})

#Interaction
#Unlike in the examination of the differences between Man and Woman, where there's only one item in each kind, here we treat Concept (specific items) as a random effect because in each of Control, Dual-Character, and Natural Kind, there are 10 items and every participant would rate all the items. 
lmv = lmer(value~Type*Statement+(1|Concept)+(1|index), dv_c1)
lmerTest::anova(lmv)
summary(lmv)

#Main effect of Concept Type
lmt = lmer(value~Type+(1|Concept)+(1|index), dv_c1)
lmerTest::anova(lmt)
summary(lmt)

#Main effect of Statement Type
lms = lmer(value~Statement+(1|Concept)+(1|index), dv_c1)
lmerTest::anova(lms)
summary(lms)
```
There was a significant interaction between statement and concept type. The main effects are not of interest in the current study because they are not informative. 

##Specific tests to entangle the interaction between concept type and statement type. 
```{r message=FALSE, warning=FALSE}

#examine only for control
dv_control = dv_c1 %>%
  filter(Type == "Control")

lmv4 = lmer(value~Statement+(1|Concept)+(1|index), dv_control)
lmerTest::anova(lmv4)
summary(lmv4)



#examine only for Man -- only one item within this type, therefore not including concept as a random effect
dv_man = dv_c1 %>%
  filter(Type == "Man")

lmv5 = lmer(value~Statement+(1|index), dv_man)
lmerTest::anova(lmv5)
summary(lmv5)



#examine only for Woman -- only one item within this type, therefore not including concept as a random effect
dv_woman = dv_c1 %>%
  filter(Type == "Woman")

lmv7 = lmer(value~Statement+(1|index), dv_woman)
lmerTest::anova(lmv7)
summary(lmv7)



#examine only for Dual-Character
dv_dual = dv_c1 %>%
  filter(Type == "DualCharacter") 
lmv9 = lmer(value~Statement+(1|Concept)+(1|index), dv_dual)
lmerTest::anova(lmv9)
summary(lmv9)



#examine only for Natural Kind
dv_natural = dv_c1 %>%
  filter(Type == "NaturalKind") 
lmv12 = lmer(value~Statement+(1|Concept)+(1|index), dv_natural)
lmerTest::anova(lmv12)
summary(lmv12)



#Compare Control and Man
dv_cm = dv_c1 %>%
  filter(Type == "Control"| Type == "Man")
##Interaction
lmv3 = lmer(value~Type*Statement+(1|Concept)+(1|index), dv_cm)
lmerTest::anova(lmv3)
summary(lmv3)
##Main effect of concept type
lmv31 = lmer(value~Type+(1|Concept)+(1|index), dv_cm)
lmerTest::anova(lmv31)
summary(lmv31)



#Compare Control and Woman
dv_cw = dv_c1 %>%
  filter(Type == "Control"| Type == "Woman")
##Interaction
lmv6 = lmer(value~Type*Statement+(1|Concept)+(1|index), dv_cw)
lmerTest::anova(lmv6)
summary(lmv6)
##Main effect of concept type
lmv61 = lmer(value~Type+(1|Concept)+(1|index), dv_cw)
lmerTest::anova(lmv61)
summary(lmv61)



#Compare Dual Character and Man
dv_dm = dv_c1 %>%
  filter(Type == "DualCharacter"| Type == "Man")
##Interaction
lmv8 = lmer(value~Type*Statement+(1|Concept)+(1|index), dv_dm)
lmerTest::anova(lmv8)
summary(lmv8)
##Main effect of concept type
lmv81 = lmer(value~Type+(1|Concept)+(1|index), dv_dm)
lmerTest::anova(lmv81)
summary(lmv81)




#Compare Dual Character and Woman
dv_dw = dv_c1 %>%
  filter(Type == "DualCharacter"| Type == "Woman")
##Interaction
lmv10 = lmer(value~Type*Statement+(1|Concept)+(1|index), dv_dw)
lmerTest::anova(lmv10)
summary(lmv10)
##Main effect of concept type
lmv101 = lmer(value~Type+(1|Concept)+(1|index), dv_dw)
lmerTest::anova(lmv101)
summary(lmv101)



#Compare Natural Kind and Man
dv_nm = dv_c1 %>%
  filter(Type == "NaturalKind"| Type == "Man")
##Interaction
lmv11 = lmer(value~Type*Statement+(1|Concept)+(1|index), dv_nm)
lmerTest::anova(lmv11)
summary(lmv11)
##Main effect of concept type
lmv111 = lmer(value~Type+(1|Concept)+(1|index), dv_nm)
lmerTest::anova(lmv111)
summary(lmv111)



#Compare Natural Kind and Woman
dv_nw = dv_c1 %>%
  filter(Type == "NaturalKind"| Type == "Woman")
##Interaction
lmv13 = lmer(value~Type*Statement+(1|Concept)+(1|index), dv_nw)
lmerTest::anova(lmv13)
summary(lmv13)
##Main effect of concept type
lmv131 = lmer(value~Type+(1|Concept)+(1|index), dv_nw)
lmerTest::anova(lmv131)
summary(lmv131)



#Compare Control and Dual Character
dv_dc = dv_c1 %>%
  filter(Type == "Control"| Type == "DualCharacter")
##Interaction
lmv14 = lmer(value~Type*Statement+(1|Concept)+(1|index), dv_dc)
lmerTest::anova(lmv14)
summary(lmv14)
##Main effect of concept type
lmv141 = lmer(value~Type+(1|Concept)+(1|index), dv_dc)
lmerTest::anova(lmv141)
summary(lmv141)



#Compare Control and Natural Kind
dv_cn = dv_c1 %>%
  filter(Type == "Control"| Type == "NaturalKind")
##Interaction
lmv15 = lmer(value~Type*Statement+(1|Concept)+(1|index), dv_cn)
lmerTest::anova(lmv15)
summary(lmv15)
##Main effect of concept type
lmv151 = lmer(value~Type+(1|Concept)+(1|index), dv_cn)
lmerTest::anova(lmv151)
summary(lmv151)



#Compare Dual Character and Natural Kind
dv_dn = dv_c1 %>%
  filter(Type == "DualCharacter"| Type == "NaturalKind")
##Interaction
lmv16 = lmer(value~Type*Statement+(1|Concept)+(1|index), dv_dn)
lmerTest::anova(lmv16)
summary(lmv16)
##Main effect of concept type
lmv161 = lmer(value~Type+(1|Concept)+(1|index), dv_dn)
lmerTest::anova(lmv161)
summary(lmv161)
```
The results showed that the types of concepts all differed significantly from one another. Specifically, while there was no significant diffrence between participants' ratings of member statements and their ratings of non-member statements for dual-character concepts, there was significant difference between participants' ratings for the two types of statements for other types of concepts: (1) for control concepts, man, and woman, participants' ratings of member statements were significantly higher than their ratings of non-member statements, but the degree of the difference between ratings of the two types of statements differed significantly for control concepts, man, and woman; (2) for natural kinds, participants' ratings of member statements were significantly lower than their ratings of non-member statements. 


```{r message=FALSE, warning=FALSE, echo=FALSE}
sem <- function(x) {sd(x, na.rm=TRUE) / sqrt(length(x))}

ci <- function(x) {qt(.975, df=length(x)-1)*sem(x)}

aggv2 <- dv_c1 %>%
  group_by(Type, Statement) %>%
  summarise(Mean = mean(value,na.rm=T),
            se = ci(value),
            upper = Mean + se,
            lower = Mean - se)

ggplot(aggv2,aes(x=Type, y=Mean, fill=Statement, label = round(Mean, digits=2))) +
  geom_bar(position="dodge", stat="identity", col="black") + scale_fill_manual(values=c("grey", "white")) +
  geom_errorbar(   aes( ymax=upper, ymin=lower ) , 
                     		width   =.25,
	                    	linetype="solid", position=position_dodge(.9)
	                    	) + 
  theme_bw() + ggtitle("Ratings of Statements by Concept and Statement Type") + geom_text(size = 3, position = position_dodge(width=.9), vjust=7) + scale_x_discrete(limits = c("DualCharacter", "Control", "NaturalKind", "Man", "Woman")) + scale_y_discrete(limits=seq(0,7, by=1))+labs(x = "Concept Type")
```

#BayesFactor analyses for examining to which type of concepts Man and Woman are closest to, respectively [for Studies 2b, 4a, and 4b, we would conduct these analyses if the linear mixed models showed that gender concepts were significantly different from all other concept types, to infer which type of concepts gender concepts are closest to despite being different from all of them].

```{r}
#creating new Type variables to prepare for the BayesFactor analyses.
##Type1 is for the model A where Dual-Character and Man are treated as the same
##Type2 is for the model B where Control and Man are treated as the same
##Type3 is for the model C where NaturalKind and Man are treated as the same
##Type4 is for the model D where Dual-Character and Woman are treated as the same
##Type5 is for the model E where Control and Woman are treated as the same
##Type6 is for the model F where NaturalKind and Woman are treated as the same

dv_d = dv_c1 %>%
  mutate(Type1 = recode(Type, "c('DualCharacter', 'Man') = 'DM'"), Type2 = recode(Type, "c('Control', 'Man') = 'CM'"), Type3 = recode(Type, "c('NaturalKind', 'Man') = 'NM'"), Type4 = recode(Type, "c('DualCharacter', 'Woman') = 'DW'"), Type5 = recode(Type, "c('Control', 'Woman') = 'CW'"), Type6 = recode(Type, "c('NaturalKind', 'Woman') = 'NW'"))

dv_d$value = as.numeric(dv_d$value)

#bf1 is the all-different model where Dual-Character, Control, Natural Kind, Man, and Woman are all separate
bf1 = lmBF(value~Type+Statement+Type*Statement, data = as.data.frame(dv_d), whichRandom = c("Concept", "index"))
bf1

#bf2 is the model A where man = dual character but not others

bf2 = lmBF(value~Type1+Statement+Type1*Statement, data = as.data.frame(dv_d), whichRandom = c("Concept", "index"))
bf2

#compare model A and the all-different model
bf_tests = c(bf1, bf2)
bf_tests

#since bf1's Bayes factor is bigger than that of bf2, we put bf1's factor as the numerator and bf2's factor as the denominator to see how much bigger bf1 factor is than bf2 factor.
bf_tests[1]/bf_tests[2]

#bf3 is the model B where man = control but not others
bf3 = lmBF(value~Type2+Statement+Type2*Statement, data = as.data.frame(dv_d), whichRandom = c("Concept", "index"))
bf3

#compare model B and the all-different model
bf_tests2 = c(bf1, bf3)
bf_tests2
#since bf1's Bayes factor is bigger than that of bf3, we put bf1's factor as the numerator and bf3's factor as the denominator to see how much bigger bf1 factor is than bf3's factor.
bf_tests2[1]/bf_tests2[2] 

#now we directly compare Model A and B
bf_tests3 = c(bf2, bf3)
bf_tests3
#since bf3's Bayes factor is bigger than that of bf2, we put bf3's factor as the numerator and bf2's factor as the denominator to see how much bigger bf3's factor is than bf1's factor.
bf_tests3[2]/bf_tests3[1]

#bf4 is the model C where man = natural kind but not others
bf4 = lmBF(value~Type3+Statement+Type3*Statement, data = as.data.frame(dv_d), whichRandom = c("Concept", "index"))
bf4

#compare model C and the all-different model
bf_tests4 = c(bf1, bf4)
bf_tests4
#since bf3's Bayes factor is bigger than that of bf1, we put bf3's factor as the numerator and bf1's factor as the denominator to see how much bigger bf3 factor is than bf1 factor.
bf_tests4[2]/bf_tests4[1] 

#now we directly compare Model C and A
bf_tests5 = c(bf2, bf4)
bf_tests5
#since bf2's Bayes factor is bigger than that of bf4, we put bf2's factor as the numerator and bf4's factor as the denominator to see how much bigger bf2's factor is than bf4's factor.
bf_tests5[1]/bf_tests5[2]

#now we directly compare Model C and B
bf_tests6 = c(bf3, bf4)
bf_tests6
#since bf3's Bayes factor is bigger than that of bf4, we put bf3's factor as the numerator and bf4's factor as the denominator to see how much bigger bf3's factor is than bf4's factor.
bf_tests6[1]/bf_tests6[2]


#bf5 is the model D where woman = dual but not others
bf5 = lmBF(value~Type4+Statement+Type4*Statement, data = as.data.frame(dv_d), whichRandom = c("Concept", "index"))
bf5

#compare model D and all-different model
bf_tests7 = c(bf1, bf5)
bf_tests7
bf_tests7[1]/bf_tests7[2]

#bf6 is the model E where woman = control but not others
bf6 = lmBF(value~Type5+Statement+Type5*Statement, data = as.data.frame(dv_d), whichRandom = c("Concept", "index"))
bf6

#compare model E and the all-different model
bf_tests8 = c(bf1, bf6)
bf_tests8
bf_tests8[1]/bf_tests8[2]

#compare models D and E
bf_tests9 = c(bf5, bf6)
bf_tests9
bf_tests9[2]/bf_tests9[1]

#bf7 is the model F where woman = natural kind but not others
bf7 = lmBF(value~Type6+Statement+Type6*Statement, data = as.data.frame(dv_d), whichRandom = c("Concept", "index"))
bf7

#compare model F and the all-diffferent model
bf_tests10 = c(bf1, bf7)
bf_tests10
bf_tests10[1]/bf_tests10[2]

#compare model F and D
bf_tests11 = c(bf5, bf7)
bf_tests11
bf_tests11[1]/bf_tests11[2]

#compare model F and E
bf_tests12 = c(bf6, bf7)
bf_tests12
bf_tests12[1]/bf_tests12[2]
```
Bayes factors might change slightly each time the analyses are re-ran due to the nature of the stochastic approximation approach to calculating Bayes factors. 

The Bayes factors revealed that for Man, the model that treats Man as the same as control concepts was the best model in that it was significantly better than the model that treats Man as the same as dual character concepts by a Bayes factor of 4.21e+58, and better than the model that treats Man as the same as natural kinds by a Bayes factor of 7.80e+228. Therefore, although Man was significantly different from all other types of concepts, Man was closest to control concepts in this case. 

The same pattern held for Woman, such that the model that treats Woman as the same as control concepts was the best model -- it was significantly better than the model that treats Woman as the same as dual character concepts by a Bayes factor of 4.82e+85, and better than the model that treats Woman as the same as natural kinds by a Bayes factor of 2.69e+283. Therefore, although Woman was significantly different from all other types of concepts, Woman was closest to control concepts in this case. 

#Histograms for each type of concept by statement type
```{r}
dv_s = dv_c1 %>%
  filter(Statement  == "Member")
#For Man
g1=ggplot(subset(dv_s, Type == "Man"), aes(x=value)) +
  geom_histogram(breaks=seq(0,7, by=1), aes(y = (..count..)/sum(..count..)),
    stat = "count",
                 col="black",
                 fill="grey") +
  labs(x="Rating", y="Percentage") + scale_x_discrete(limits=c(0,1,2,3,4,5,6,7)) + ggtitle("Man - Member Statement")+ scale_y_continuous(labels = scales::percent, limits = c(0,1), breaks = seq(0,1, by=0.1))+theme(panel.grid.major = element_line(colour="grey", size = (0.5)),
                 panel.grid.minor = element_line(size = (0.2), colour="grey"))
g1

#For Woman
g2=ggplot(subset(dv_s, Type == "Woman"), aes(x=value)) +
  geom_histogram(breaks=seq(0,7, by=1), aes(y = (..count..)/sum(..count..)),
    stat = "count",
                 col="black",
                 fill="grey") +
  labs(x="Rating", y="Percentage") + scale_x_discrete(limits=c(0,1,2,3,4,5,6,7)) + ggtitle("Woman - Member Statement")+ scale_y_continuous(labels = scales::percent, limits = c(0,1), breaks = seq(0,1, by=0.1))+theme(panel.grid.major = element_line(colour="grey", size = (0.5)),
                 panel.grid.minor = element_line(size = (0.2), colour="grey"))
g2

#For Dual Character
g3=ggplot(subset(dv_s, Type == "DualCharacter"), aes(x=value)) +
  geom_histogram(breaks=seq(0,7, by=1), aes(y = (..count..)/sum(..count..)),
    stat = "count",
                 col="black",
                 fill="grey") +
  labs(x="Rating", y="Percentage") + scale_x_discrete(limits=c(0,1,2,3,4,5,6,7)) + ggtitle("DualCharacter - Member Statement")+ scale_y_continuous(labels = scales::percent, limits = c(0,1), breaks = seq(0,1, by=0.1))+theme(panel.grid.major = element_line(colour="grey", size = (0.5)),
                 panel.grid.minor = element_line(size = (0.2), colour="grey"))
g3

#For Control
g4=ggplot(subset(dv_s, Type == "Control"), aes(x=value)) +
  geom_histogram(breaks=seq(0,7, by=1), aes(y = (..count..)/sum(..count..)),
    stat = "count",
                 col="black",
                 fill="grey") +
  labs(x="Rating", y="Percentage") + scale_x_discrete(limits=c(0,1,2,3,4,5,6,7)) + ggtitle("Control - Member Statement")+ scale_y_continuous(labels = scales::percent, limits = c(0,1), breaks = seq(0,1, by=0.1))+theme(panel.grid.major = element_line(colour="grey", size = (0.5)),
                 panel.grid.minor = element_line(size = (0.2), colour="grey"))
g4

#For Natural Kind
g5=ggplot(subset(dv_s, Type == "NaturalKind"), aes(x=value)) +
  geom_histogram(breaks=seq(0,7, by=1), aes(y = (..count..)/sum(..count..)),
    stat = "count",
                 col="black",
                 fill="grey") +
  labs(x="Rating", y="Percentage") + scale_x_discrete(limits=c(0,1,2,3,4,5,6,7)) + ggtitle("NaturalKind - Member Statement")+ scale_y_continuous(labels = scales::percent, limits = c(0,1), breaks = seq(0,1, by=0.1))+theme(panel.grid.major = element_line(colour="grey", size = (0.5)),
                 panel.grid.minor = element_line(size = (0.2), colour="grey"))
g5

#Histograms for Nonmember Statement
dv_n = dv_c1 %>%
  filter(Statement == "Nonmember")

#For Man
g6=ggplot(subset(dv_n, Type == "Man"), aes(x=value)) +
  geom_histogram(breaks=seq(0,7, by=1), aes(y = (..count..)/sum(..count..)),
    stat = "count",
                 col="black",
                 fill="grey") +
  labs(x="Rating", y="Percentage") + scale_x_discrete(limits=c(0,1,2,3,4,5,6,7)) + ggtitle("Man - Nonmember Statement")+ scale_y_continuous(labels = scales::percent, limits = c(0,1), breaks = seq(0,1, by=0.1))+theme(panel.grid.major = element_line(colour="grey", size = (0.5)),
                 panel.grid.minor = element_line(size = (0.2), colour="grey"))
g6

#For Woman
g7=ggplot(subset(dv_n, Type == "Woman"), aes(x=value)) +
  geom_histogram(breaks=seq(0,7, by=1), aes(y = (..count..)/sum(..count..)),
    stat = "count",
                 col="black",
                 fill="grey") +
  labs(x="Rating", y="Percentage") + scale_x_discrete(limits=c(0,1,2,3,4,5,6,7)) + ggtitle("Woman - Nonmember Statement")+ scale_y_continuous(labels = scales::percent, limits = c(0,1), breaks = seq(0,1, by=0.1))+theme(panel.grid.major = element_line(colour="grey", size = (0.5)),
                 panel.grid.minor = element_line(size = (0.2), colour="grey"))
g7

#For Dual Character
g8=ggplot(subset(dv_n, Type == "DualCharacter"), aes(x=value)) +
  geom_histogram(breaks=seq(0,7, by=1), aes(y = (..count..)/sum(..count..)),
    stat = "count",
                 col="black",
                 fill="grey") +
  labs(x="Rating", y="Percentage") + scale_x_discrete(limits=c(0,1,2,3,4,5,6,7)) + ggtitle("DualCharacter - Nonmember Statement")+ scale_y_continuous(labels = scales::percent, limits = c(0,1), breaks = seq(0,1, by=0.1))+theme(panel.grid.major = element_line(colour="grey", size = (0.5)),
                 panel.grid.minor = element_line(size = (0.2), colour="grey"))
g8

#For Control
g9=ggplot(subset(dv_n, Type == "Control"), aes(x=value)) +
  geom_histogram(breaks=seq(0,7, by=1), aes(y = (..count..)/sum(..count..)),
    stat = "count",
                 col="black",
                 fill="grey") +
  labs(x="Rating", y="Percentage") + scale_x_discrete(limits=c(0,1,2,3,4,5,6,7)) + ggtitle("Control - Nonmember Statement")+ scale_y_continuous(labels = scales::percent, limits = c(0,1), breaks = seq(0,1, by=0.1))+theme(panel.grid.major = element_line(colour="grey", size = (0.5)),
                 panel.grid.minor = element_line(size = (0.2), colour="grey"))
g9

#For Natural Kind
g10=ggplot(subset(dv_n, Type == "NaturalKind"), aes(x=value)) +
  geom_histogram(breaks=seq(0,7, by=1), aes(y = (..count..)/sum(..count..)),
    stat = "count",
                 col="black",
                 fill="grey") +
  labs(x="Rating", y="Percentage") + scale_x_discrete(limits=c(0,1,2,3,4,5,6,7)) + ggtitle("NaturalKind - Nonmember Statement")+ scale_y_continuous(labels = scales::percent, limits = c(0,1), breaks = seq(0,1, by=0.1))+theme(panel.grid.major = element_line(colour="grey", size = (0.5)),
                 panel.grid.minor = element_line(size = (0.2), colour="grey"))
g10
```
